# 班级成绩分析系统

## 项目简介

班级成绩分析系统是一个基于Streamlit和Pandas开发的Web应用，用于分析和可视化班级成绩数据。该系统支持数据导入、数据处理、班级总分分析和成绩趋势分析等功能，帮助教师和管理者更直观地了解班级成绩情况。

## 功能特点

### 1. 数据导入
- 支持上传.xlsx和.csv格式的数据文件
- 自动保存上传的文件到本地
- 实时更新文件列表
- 支持删除已上传的文件

### 2. 数据处理
- 数据清洗：处理重复值和缺失值
- 填充空值：支持多种填充方式
- 数据预览：实时查看处理后的数据

### 3. 班级总分分析
- 按月份查看班级总分数据
- 支持从高到低或从低到高排序
- 自动计算统计信息（最高分、最低分、平均分、标准差）
- 数据标注：前5名标注为"优秀"，后5名标注为"待提高"，其他根据与平均分的比较标注为"良好"或"合格"
- 彩色标注：不同标注的行显示不同的背景颜色，便于快速识别

### 4. 成绩趋势分析
- 按月份查看成绩趋势
- 支持多种图表类型（柱状图、折线图、散点图等）
- 支持自定义颜色方案
- 显示详细的统计信息

## 技术栈

- **前端框架**：Streamlit
- **数据处理**：Pandas
- **数据可视化**：Plotly Express
- **文件操作**：os模块
- **HTML/CSS**：自定义表格样式

## 安装说明

### 1. 环境要求

- Python 3.7+
- pip（Python包管理工具）

### 2. 安装依赖

1. 克隆项目到本地：
   ```bash
   git clone <项目地址>
   cd <项目目录>
   ```

2. 安装依赖包：
   ```bash
   pip install -r requirements.txt
   ```

### 3. 依赖包清单

如果没有`requirements.txt`文件，可以手动安装以下包：
```bash
pip install streamlit pandas openpyxl plotly
```

## 使用方法

### 1. 启动应用

在项目目录下运行：
```bash
streamlit run web_app.py
```

应用将在浏览器中打开，默认地址为 `http://localhost:8501`。

### 2. 数据导入

1. 点击左侧导航栏中的"数据导入"
2. 点击"上传数据文件"按钮，选择要上传的.xlsx或.csv文件
3. 上传完成后，文件会自动保存到`data`文件夹
4. 在"选择本地已有的数据文件"下拉列表中选择要读取的文件
5. 点击"读取数据"按钮查看数据预览

### 3. 数据处理

1. 点击左侧导航栏中的"数据处理"
2. 选择要处理的数据文件
3. 根据需要选择数据清洗和填充空值的选项
4. 查看处理后的数据预览

### 4. 班级总分分析

1. 点击左侧导航栏中的"班级总分分析"
2. 在"选择月份"下拉列表中选择要分析的月份
3. 选择排序方式（从高到低或从低到高）
4. 查看班级总分数据表格，表格会根据标注显示不同的背景颜色
5. 选择图表类型和颜色方案，查看可视化效果
6. 查看统计信息（最高分、最低分、平均分、标准差）

### 5. 成绩趋势分析

1. 点击左侧导航栏中的"成绩趋势分析"
2. 选择要分析的月份范围
3. 选择要分析的科目
4. 选择图表类型和颜色方案
5. 查看成绩趋势图表和统计信息

## 数据格式要求

### Excel文件格式

Excel文件应包含以下列：
- `班级`：班级名称
- `实际班级总分`：班级总分
- 其他科目列（如语文、数学、英语等）

### CSV文件格式

CSV文件应包含与Excel文件相同的列，且从第3行开始为数据行。

## 项目结构

```
.
├── web_app.py          # 主应用文件
├── data_processing.py  # 数据导入和处理功能
├── class_score_analysis.py  # 班级总分分析功能
├── trend_analysis.py   # 成绩趋势分析功能
├── styles.py           # 自定义样式
├── data/               # 数据文件目录
└── README.md           # 项目说明文件
```

## 注意事项

1. 请确保上传的文件格式正确，包含必要的列
2. 对于CSV文件，系统会从第3行开始读取数据
3. 数据文件会保存在`data`文件夹中，请确保该文件夹有写入权限
4. 建议使用Chrome、Firefox等现代浏览器访问应用

## 常见问题

### 1. 上传文件失败

- 检查文件格式是否为.xlsx或.csv
- 检查文件大小是否过大
- 检查`data`文件夹是否有写入权限

### 2. 数据显示不正确

- 检查数据文件是否包含必要的列
- 检查数据格式是否正确
- 对于CSV文件，确保数据从第3行开始

### 3. 图表显示异常

- 检查数据是否完整
- 尝试刷新页面
- 尝试使用不同的浏览器

## 许可证

本项目仅供学习和教育目的使用。

## 联系方式

如有问题或建议，请联系项目维护者。