# 班级量化考核智能分析系统

## 项目简介

班级量化考核智能分析系统是一个基于Streamlit和Pandas开发的Web应用，用于分析和可视化学校班级量化考核数据。该系统支持数据导入、数据处理、班级总分分析、考核项目分析和趋势预测等功能，帮助学校管理者和教师更直观地了解班级考核情况，发现问题并做出科学决策。

## 功能特点

### 1. 数据导入
- 支持上传.xlsx和.csv格式的数据文件
- 自动保存上传的文件到本地`data`目录
- 实时更新文件列表
- 支持删除已上传的文件

### 2. 数据处理
- 数据清洗：处理重复值和缺失值
- 填充空值：支持自动填充空值
- 数据预览：实时查看处理后的数据

### 3. 班级总分分析
- 按月份查看班级总分数据
- 支持从高到低或从低到高排序
- 自动计算统计信息（最高分、最低分、平均分、标准差）
- 数据标注：前5名标注为"优秀"，后5名标注为"待提高"，其他根据与平均分的比较标注为"良好"或"合格"
- 彩色标注：不同标注的行显示不同的背景颜色，便于快速识别

### 4. 考核项目分析
- 按月份查看各考核项目的详细数据
- 支持多种图表类型（柱状图、折线图、散点图）
- 支持自定义颜色方案
- 显示详细的统计信息

## 技术栈

- **前端框架**：Streamlit
- **数据处理**：Pandas、NumPy
- **数据可视化**：Plotly Express、Plotly Graph Objects
- **文件操作**：os模块、glob模块
- **HTML/CSS**：自定义表格样式和页面美化

## 安装说明

### 1. 环境要求

- Python 3.7+
- pip（Python包管理工具）

### 2. 安装依赖

1. 克隆项目到本地：
   ```bash
   git clone <项目地址>
   cd <项目目录>
   ```

2. 安装依赖包：
   ```bash
   pip install -r requirements.txt
   ```

### 3. 依赖包清单

```bash
streamlit==1.52.2
pandas==2.2.3
openpyxl==3.1.5
plotly==6.5.0
numpy==2.1.3
```

## 使用方法

### 1. 启动应用

在项目目录下运行：
```bash
streamlit run web_app.py
```

应用将在浏览器中打开，默认地址为 `http://localhost:8501`。

### 2. 数据导入

1. 点击左侧导航栏中的"📁 数据导入"
2. 点击"上传数据文件"按钮，选择要上传的.xlsx或.csv文件
3. 上传完成后，文件会自动保存到`data`文件夹
4. 在"选择本地已有的数据文件"下拉列表中选择要读取的文件
5. 点击"读取数据"按钮查看数据预览

### 3. 数据处理

1. 点击左侧导航栏中的"🔧 数据处理"
2. 选择要处理的数据文件
3. 系统自动清洗重复值并填充空值
4. 查看处理后的数据预览

### 4. 班级总分分析

1. 点击左侧导航栏中的"📊 班级总分分析"
2. 在"选择月份"下拉列表中选择要分析的月份
3. 选择排序方式（从高到低或从低到高）
4. 查看班级总分数据表格，表格会根据标注显示不同的背景颜色
5. 选择图表类型和颜色方案，查看可视化效果
6. 查看统计信息（最高分、最低分、平均分、标准差）

### 5. 考核项目分析

1. 点击左侧导航栏中的"📈 考核项目分析"
2. 选择要分析的月份和考核项目
3. 选择图表类型和颜色方案
4. 查看考核项目得分分布图表和统计信息

### 6. 查看前5名

1. 点击左侧导航栏中的"🏆 查看前5名"
2. 选择要分析的月份
3. 查看排名前5的班级详细数据
4. 查看可视化图表

### 7. 变化趋势和风险预测

1. 点击左侧导航栏中的"📉 变化趋势和风险预测"
2. 选择要分析的月份范围
3. 选择要分析的考核项目
4. 查看趋势变化图表和预测结果
5. 查看风险预警信息

## 数据格式要求

### Excel文件格式

Excel文件应包含以下列：
- `班级`：班级名称
- `实际班级总分`：班级总分
- `初始分数`：班级初始分数
- 其他考核项目列（如教室卫生、校服衣着、两操等）

### CSV文件格式

CSV文件是从微信小程序"班级量化考核智能助手"导出的，从第3行开始为数据行。

## 项目结构

```
.
├── web_app.py                 # 主应用文件，整合所有功能模块
├── data_import.py             # 数据导入功能模块
├── data_processing.py         # 数据处理功能模块
├── class_score_analysis.py    # 班级总分分析功能模块
├── assessment_item_analysis.py # 考核项目分析功能模块
├── rankings.py                # 排名分析功能模块
├── trend_analysis.py          # 趋势分析功能模块
├── sidebar.py                 # 侧边栏导航模块
├── styles.py                  # 自定义样式模块
├── data/                      # 数据文件目录
├── charts/                    # 图表保存目录
├── .streamlit/                # Streamlit配置目录
├── README.md                  # 项目说明文件
├── requirements.txt           # 依赖包清单
└── 概要设计说明.md             # 项目设计文档
```

## 注意事项

1. 请确保上传的文件格式正确，包含必要的列
2. 对于CSV文件，系统会从第3行开始读取数据
3. 数据文件会保存在`data`文件夹中，请确保该文件夹有写入权限
4. 图表会自动保存到`charts`文件夹中
5. 建议使用Chrome、Firefox等现代浏览器访问应用
6. 系统支持深色/浅色主题切换

## 常见问题

### 1. 上传文件失败

- 检查文件格式是否为.xlsx或.csv
- 检查文件大小是否过大
- 检查`data`文件夹是否有写入权限

### 2. 数据显示不正确

- 检查数据文件是否包含必要的列
- 检查数据格式是否正确
- 对于CSV文件，确保数据从第3行开始

### 3. 图表显示异常

- 检查数据是否完整
- 尝试刷新页面
- 尝试使用不同的浏览器

### 4. 趋势预测不准确

- 确保有足够的历史数据（至少3个月）
- 线性回归预测仅适用于短期趋势分析

## 许可证

本项目仅供学习和教育目的使用。

## 联系方式

如有问题或建议，请联系项目维护者。