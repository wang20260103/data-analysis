# 班级量化考核数据智能分析平台
## 概要设计说明

### 1. 项目概述

#### 1.1 项目背景
在学校班级管理中，对班级进行量化考核是提高管理效率和教学质量的重要手段。传统的考核数据处理方式效率低下，难以进行深入分析和趋势预测。本项目旨在开发一个基于Web的智能分析平台，实现考核数据的自动化处理、可视化分析和风险预测，为学校管理者提供科学决策依据。

#### 1.2 项目目标
- 实现班级考核数据的高效导入和管理
- 提供多种数据分析和可视化功能
- 支持班级排名、总分分析、考核项目分析等
- 实现变化趋势分析和风险预测
- 提供友好的用户界面，提高操作便捷性

#### 1.3 适用范围
本系统适用于各级各类学校的班级量化考核数据管理和分析，特别适合需要对班级进行定期考核和管理的教育机构。

### 2. 系统架构

#### 2.1 整体架构
本系统采用**模块化设计**，基于Streamlit框架构建，采用前后端一体化开发模式。系统主要分为以下几个层次：

- **表现层**：负责用户界面的展示和交互
- **业务逻辑层**：实现核心业务逻辑和数据分析功能
- **数据访问层**：负责数据的导入、存储和读取
- **工具层**：提供通用功能和辅助工具

#### 2.2 模块关系
系统各模块之间的关系如下：

```
┌───────────────────────────────────────────────────────────────┐
│                     web_app.py (主应用入口)                    │
└───────────────────┬───────────────────────────────────────────┘
                    │
        ┌───────────┼───────────┐
        ▼           ▼           ▼
┌─────────────┐ ┌─────────────┐ ┌─────────────┐
│   sidebar   │ │   styles    │ │ data_import │
└─────────────┘ └─────────────┘ └─────────────┘
                    │
        ┌───────────┼───────────┐
        ▼           ▼           ▼
┌─────────────┐ ┌─────────────┐ ┌─────────────┐
│data_processing││   rankings  │ │class_score_analysis│
└─────────────┘ └─────────────┘ └─────────────┘
                    │
        ┌───────────┼───────────┐
        ▼           ▼           ▼
┌─────────────────────────┐ ┌─────────────────────────┐
│assessment_item_analysis │ │ trend_analysis          │
└─────────────────────────┘ └─────────────────────────┘
```

### 3. 功能模块设计

#### 3.1 数据导入模块 (data_import.py)
**功能**：实现考核数据的上传、选择、读取和删除功能

**主要流程**：
- 用户通过文件上传组件选择数据文件
- 系统自动保存上传的文件到本地目录
- 用户可以选择已上传的文件进行读取
- 支持Excel (.xlsx)和CSV (.csv)格式
- CSV文件从第3行开始读取数据

#### 3.2 数据处理模块 (data_processing.py)
**功能**：实现数据清洗和空值填充功能

**主要功能点**：
- 数据质量分析（重复行、缺失值检测）
- 删除重复行
- 空值填充（使用0填充）
- 清洗前后数据对比

#### 3.3 班级排名模块 (rankings.py)
**功能**：实现班级排名功能，包括前5名和后5名班级的展示和分析

**主要功能点**：
- 查看前5名班级
- 查看后5名班级
- 排名可视化展示
- 扣分项分析和改进建议生成

#### 3.4 班级总分分析模块 (class_score_analysis.py)
**功能**：实现班级总分的详细分析和可视化

**主要功能点**：
- 总分统计和排序
- 等级标注（优秀、良好、合格、待提高）
- 多种图表展示（柱状图、折线图、散点图）
- 平均分计算和对比

#### 3.5 考核项目分析模块 (assessment_item_analysis.py)
**功能**：实现考核项目的深入分析

**主要功能点**：
- 考核项目加减分统计
- 高频扣分项分析
- 项目可视化对比
- 改进建议生成

#### 3.6 变化趋势和风险预测模块 (trend_analysis.py)
**功能**：实现班级总分的变化趋势分析和风险预测

**主要功能点**：
- 多月份数据对比
- 班级纵向趋势分析
- 风险预测算法（基于线性回归）
- 风险班级可视化

#### 3.7 界面和样式模块
- **sidebar.py**：实现侧边栏导航和会话状态管理
- **styles.py**：提供自定义CSS样式，美化界面

### 4. 数据结构设计

#### 4.1 数据文件格式
系统支持以下数据文件格式：
- **Excel文件 (.xlsx)**：包含班级考核数据的标准格式
- **CSV文件 (.csv)**：从第3行开始读取有效数据

#### 4.2 核心数据字段
```
┌───────────────────┐
│   班级考核数据结构  │
├───────────────────┤
│ 编号              │
│ 班级              │
│ 初始分数          │
│ 实际班级总分      │
│ 考核项目1         │
│ 考核项目2         │
│ ...               │
│ 月份              │
└───────────────────┘
```

#### 4.3 会话状态管理
系统使用Streamlit的会话状态管理用户数据：
- `st.session_state.raw_data`：原始数据
- `st.session_state.cleaned_data`：清洗后的数据
- `st.session_state.filled_data`：填充后的数据
- `st.session_state.current_file`：当前选择的文件

### 5. 界面设计

#### 5.1 整体布局
系统采用**左侧导航+右侧内容**的布局方式：
- **左侧**：固定的侧边栏导航
- **右侧**：动态变化的内容区域

#### 5.2 页面设计

| 页面名称 | 主要功能 | 布局特征 |
|---------|---------|---------|
| 数据导入 | 文件上传、选择和管理 | 上传组件、下拉选择、操作按钮 |
| 数据处理 | 数据清洗和填充 | 分析指标、处理选项、结果展示 |
| 班级排名 | 前5名和后5名展示 | 表格、图表、排行榜样式 |
| 总分分析 | 班级总分分析 | 排序选项、等级标注、多种图表 |
| 考核项目 | 项目分析 | 统计表格、柱状图、扣分项分析 |
| 趋势预测 | 变化趋势和风险 | 多文件选择、趋势图、风险预测 |

#### 5.3 交互设计
- **直观的操作流程**：向导式操作，减少用户学习成本
- **实时反馈**：操作后立即显示结果
- **可视化交互**：支持图表缩放、悬停查看详情
- **响应式设计**：适应不同屏幕尺寸

### 6. 主要业务流程

#### 6.1 数据导入流程
```
用户 → 选择文件 → 上传文件 → 系统保存文件 → 更新文件列表 → 选择文件 → 读取数据 → 显示数据预览
```

#### 6.2 数据分析流程
```
用户 → 选择数据源 → 选择分析功能 → 设置分析参数 → 执行分析 → 查看分析结果 → 导出/保存结果
```

#### 6.3 风险预测流程
```
用户 → 选择多个月份数据 → 系统加载并合并数据 → 计算趋势斜率 → 识别风险班级 → 生成风险报告 → 可视化展示
```

### 7. 技术栈与依赖

#### 7.1 核心技术
- **前端框架**：Streamlit
- **数据处理**：Pandas
- **可视化**：Plotly
- **数值计算**：NumPy
- **文件操作**：os模块

#### 7.2 依赖清单
| 依赖包 | 版本 | 用途 |
|-------|------|------|
| streamlit | 1.52.2 | Web应用框架 |
| pandas | 2.2.3 | 数据处理 |
| openpyxl | 3.1.5 | Excel文件读取 |
| plotly | 6.5.0 | 数据可视化 |
| numpy | 2.1.3 | 数值计算 |

### 8. 部署与运行

#### 8.1 开发环境
- 操作系统：Windows/macOS/Linux
- Python版本：3.8+
- 依赖管理：pip

#### 8.2 部署方式
1. 安装依赖：`pip install -r requirements.txt`
2. 运行应用：`streamlit run web_app.py`
3. 访问地址：http://localhost:8501

#### 8.3 运行环境要求
- 内存：至少4GB
- 存储空间：至少100MB可用空间
- 网络：无特殊要求，支持离线运行

### 9. 质量保证

#### 9.1 代码规范
- 采用PEP 8代码规范
- 充分的注释说明
- 模块化设计，提高代码可维护性

#### 9.2 测试策略
- 单元测试：对核心功能进行测试
- 集成测试：测试模块间的交互
- 用户测试：收集用户反馈，优化界面和功能

### 10. 项目管理

#### 10.1 开发计划
- 需求分析：已完成
- 概要设计：当前阶段
- 详细设计：待完成
- 编码实现：待完成
- 测试验收：待完成
- 部署上线：待完成

#### 10.2 风险评估
- **技术风险**：部分数据分析算法可能需要优化
- **数据风险**：数据格式不一致可能导致导入失败
- **用户风险**：用户对新系统的接受度需要时间

---

**文档版本**：V1.0
**编写日期**：2026-01-12
**编写人**：班级量化考核数据智能分析平台开发团队